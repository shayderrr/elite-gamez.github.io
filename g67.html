<!doctype html>
<html>

<head></head>

<body>
	<!DOCTYPE html>
	<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>Elite Gamez</title>
		<style>
			:root {
				--bg: #0b0b0b;
				--header-bg: #111;
				--text: #ffffff;
				--muted: #cccccc;
				--accent: #ff6600;
				--accent-dark: #ff3300;
				--accent-shadow: rgba(255, 102, 0, 0.2);
				--card-bg: #000000;
				--card-radius: 10px;
				--card-shadow: 0 0 10px rgba(255, 102, 0, 0.2);
				--glow-size: 15px;
				--glow-strength: 0.25;
				--font-family: Arial, Helvetica, sans-serif;
				--snow-color: rgba(255, 255, 255, 0.95);
				--snow-count: 150;
				--snow-size: 3;
				--snow-speed: 1.2;
			}

			body {
				margin: 0;
				font-family: var(--font-family);
				background: var(--bg);
				color: var(--text);
			}

			#snowCanvas {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				pointer-events: none;
				z-index: -1;
				mix-blend-mode: screen;
			}

			header {
				position: fixed;
				top: 20px;
				left: 50%;
				transform: translateX(-50%);
				width: calc(100% - 40px);
				background: var(--header-bg);
				padding: 1rem;
				display: flex;
				align-items: center;
				gap: 0.8rem;
				z-index: 100;
				box-shadow: 0 0 20px var(--accent-shadow);
				border-radius: 12px;
			}

			header h1 {
				margin: 0;
				color: var(--accent);
				flex-shrink: 0;
			}

			header input {
				flex: 1;
				padding: 0.6rem 0.9rem;
				border-radius: 25px;
				border: none;
				outline: none;
				background: rgba(255, 255, 255, 0.03);
				color: var(--text);
			}

			header button {
				background: var(--accent);
				border: none;
				border-radius: 8px;
				padding: 0.6rem 1rem;
				color: #fff;
				cursor: pointer;
				font-weight: bold;
			}

			#discordBtn {
				background: #7289da;
			}

			#discordBtn:hover {
				background: #5b6eae;
			}

			#customizeBtn {
				background: transparent;
				border: 2px solid rgba(255, 255, 255, 0.06);
				color: var(--text);
				padding: 0.5rem;
				border-radius: 8px;
			}

			#gameInfo {
				padding: 8rem 2rem 0.5rem 2rem;
				color: var(--accent);
				font-weight: bold;
				font-size: 1rem;
			}

			#gameInfo p {
				margin: 0;
			}

			#gameContainer {
				padding: 0 2rem 2rem 2rem;
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
				gap: 0.8rem;
				justify-content: center;
			}

			.game-card {
				background: var(--card-bg);
				border-radius: var(--card-radius);
				padding: 1rem;
				text-align: center;
				box-shadow: var(--card-shadow);
				transition: 0.2s;
				display: flex;
				flex-direction: column;
				align-items: center;
				width: 100%;
				max-width: 250px;
				box-sizing: border-box;
			}

			.game-card:hover {
				transform: scale(1.05);
				box-shadow: 0 0 calc(var(--glow-size)) rgba(255, 102, 0, var(--glow-strength));
			}

			.game-card img {
				width: 100%;
				height: 140px;
				object-fit: cover;
				border-radius: 8px;
				margin-bottom: 0.5rem;
				cursor: pointer;
			}

			.game-card h2 {
				margin: 0.5rem 0 0;
				font-size: 1.1rem;
				text-align: center;
			}

			.game-card p {
				font-size: 0.9rem;
				color: var(--muted);
				text-align: center;
				margin-top: 0.3rem;
			}

			.modal {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100vw;
				height: 100vh;
				background: rgba(0, 0, 0, 0.95);
				justify-content: center;
				align-items: center;
				z-index: 999;
				overflow: auto;
			}

			.modal-content {
				background: var(--card-bg);
				max-width: 90vw;
				width: 900px;
				border-radius: 12px;
				padding: 1rem 1.5rem;
				display: flex;
				flex-direction: column;
				align-items: center;
				position: relative;
				box-shadow: 0 0 25px var(--accent-shadow);
				text-align: center;
			}

			#gameTitle {
				margin: 0 0 1rem;
				color: var(--accent);
				font-size: 1.5rem;
			}

			#gameFrame {
				width: 100%;
				height: 60vh;
				border: 2px solid var(--accent);
				border-radius: 8px;
				margin-bottom: 1rem;
			}

			.controls {
				display: flex;
				gap: 1rem;
				flex-wrap: wrap;
				justify-content: center;
				margin-bottom: 1rem;
			}

			.controls button {
				background: linear-gradient(135deg, var(--accent), var(--accent-dark));
				border: none;
				border-radius: 6px;
				color: #fff;
				padding: 0.8rem 1.2rem;
				font-weight: bold;
				cursor: pointer;
				transition: 0.2s;
			}

			.controls button:hover {
				transform: scale(1.05);
				box-shadow: 0 0 15px var(--accent-shadow);
			}

			.modal-content button#closeModal {
				position: absolute;
				top: 15px;
				right: 15px;
				background: var(--accent);
				border: none;
				border-radius: 50%;
				color: #fff;
				width: 40px;
				height: 40px;
				font-size: 1.5rem;
				font-weight: bold;
				line-height: 1;
				cursor: pointer;
				z-index: 1000;
				transition: background 0.2s, transform 0.2s;
			}

			.modal-content button#closeModal:hover {
				background: var(--accent-dark);
				transform: scale(1.1);
			}

			.settings-panel-large {
				display: none;
				position: fixed;
				top: 64px;
				right: 24px;
				width: 920px;
				max-width: calc(100% - 48px);
				background: var(--card-bg);
				color: var(--text);
				border-radius: 12px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
				z-index: 1200;
				padding: 14px;
				font-size: 14px;
				overflow: hidden;
			}

			.settings-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				gap: 12px;
				margin-bottom: 10px;
				cursor: move;
			}

			.settings-title {
				font-size: 18px;
				color: var(--accent);
				margin: 0;
				font-weight: 700;
			}

			.settings-close {
				background: transparent;
				border: 1px solid rgba(255, 255, 255, 0.06);
				padding: 6px 10px;
				border-radius: 8px;
				color: var(--text);
				cursor: pointer;
			}

			.settings-body {
				max-height: 62vh;
				overflow: auto;
				padding-right: 8px;
			}

			.section {
				margin-bottom: 12px;
			}

			.section h4 {
				margin: 0 0 6px 0;
				color: var(--muted);
				font-size: 13px;
			}

			.row {
				display: flex;
				gap: 12px;
				flex-wrap: wrap;
			}

			.col {
				flex: 1;
				min-width: 180px
			}

			.label {
				display: block;
				margin-bottom: 6px;
				color: var(--muted);
				font-size: 13px
			}

			input[type="color"],
			input[type="range"],
			select,
			input[type="number"] {
				width: 100%;
				padding: 8px;
				border-radius: 8px;
				border: none;
				background: rgba(255, 255, 255, 0.02);
				color: var(--text)
			}

			.small {
				width: 120px
			}

			.actions {
				display: flex;
				gap: 8px;
				justify-content: flex-end;
				margin-top: 8px
			}

			.btn-primary {
				background: var(--accent);
				border: none;
				color: #fff;
				padding: 8px 12px;
				border-radius: 8px;
				cursor: pointer
			}

			.btn-ghost {
				background: transparent;
				border: 1px solid rgba(255, 255, 255, 0.06);
				color: var(--text);
				padding: 8px 12px;
				border-radius: 8px;
				cursor: pointer
			}

			@media (max-width:980px) {
				.settings-panel-large {
					left: 12px;
					right: 12px;
					top: 72px;
					width: calc(100% - 24px)
				}
			}
		</style>
	</head>

	<body>

		<canvas id="snowCanvas"></canvas>

		<header>
			<h1>Elite Gamez</h1>
			<input type="text" id="searchInput" placeholder="Search games...">
			<button id="discordBtn">Join Discord</button>
			<button id="customizeBtn">Customize</button>
		</header>

		<div id="gameInfo">
			<p>Games: 0</p>
		</div>
		<div id="gameContainer"></div>

		<div class="modal" id="gameModal">
			<div class="modal-content">
				<button id="closeModal">&times;</button>
				<h2 id="gameTitle"></h2>
				<iframe id="gameFrame" src="" frameborder="0"></iframe>
				<div class="controls">
					<button id="downloadBtn">Download</button>
					<button id="fullscreenBtn">Fullscreen</button>
					<button id="aboutBlankBtn">Open in About:blank</button>
					<button id="blobBtn">Open in Blob URL</button>
				</div>
			</div>
		</div>

		<div class="settings-panel-large" id="settingsPanel" role="dialog" aria-label="Site customization">
			<div class="settings-header" id="settingsDrag">
				<div style="display:flex;gap:12px;align-items:center">
					<span class="settings-title">Site Customization</span>
					<small style="color:var(--muted)">(drag header to move)</small>
				</div>
				<div>
				</div>
			</div>

			<div class="settings-body">
				<div class="section">
					<h4>Presets & Quick Actions</h4>
					<div class="row">
						<div class="col" style="display:flex;gap:8px;flex-wrap:wrap">
							<button class="btn-primary" data-preset="Inferno">Inferno</button>
							<button class="btn-primary" data-preset="mathias">mathias</button>
							<button class="btn-primary" data-preset="kirby">kirby</button>
							<button class="btn-primary" data-preset="Ocean">Ocean</button>
							<button class="btn-primary" data-preset="Neon">Neon</button>
							<button class="btn-primary" data-preset="Retro">Retro</button>
							<button class="btn-ghost" data-preset="Dark">Dark</button>
							<button class="btn-ghost" data-preset="Light">Light</button>
						</div>
						<div class="col" style="display:flex;justify-content:flex-end;align-items:center">
							<button class="btn-primary" id="exportBtn">Export JSON</button>
							<button class="btn-ghost" id="importBtn">Import JSON</button>
							<input type="file" id="importFile" accept=".json" style="display:none" />
							<button class="btn-ghost" id="resetBtn">Reset Defaults</button>
						</div>
					</div>
				</div>

				<div class="section">
					<h4>Colors & Typography</h4>
					<div class="row">
						<div class="col">
							<label class="label">Background color</label>
							<input id="bgColor" type="color" value="#0b0b0b">
        </div>
							<div class="col">
								<label class="label">Header color</label>
								<input id="headerColor" type="color" value="#111111">
        </div>
								<div class="col">
									<label class="label">Text color</label>
									<input id="textColor" type="color" value="#ffffff">
        </div>
									<div class="col">
										<label class="label">Muted / Secondary text</label>
										<input id="mutedColor" type="color" value="#cccccc">
        </div>
									</div>

									<div class="row" style="margin-top:10px">
										<div class="col">
											<label class="label">Accent color</label>
											<input id="accentColor" type="color" value="#ff6600">
        </div>
											<div class="col">
												<label class="label">Accent dark</label>
												<input id="accentDark" type="color" value="#ff3300">
        </div>
												<div class="col">
													<label class="label">Glow (shadow) color</label>
													<input id="glowColor" type="color" value="#ff6600">
        </div>
													<div class="col">
														<label class="label">Card background</label>
														<input id="cardBg" type="color" value="#000000">
        </div>
													</div>

													<div class="row" style="margin-top:10px">
														<div class="col">
															<label class="label">Font family</label>
															<select id="fontFamily">
            <option value="Arial, Helvetica, sans-serif">System - Arial</option>
            <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
            <option value="'Roboto', Arial, sans-serif">Roboto</option>
            <option value="'VT323', monospace">VT323 (gamey)</option>
            <option value="'Press Start 2P', cursive">Press Start (pixel)</option>
          </select>
														</div>
														<div class="col">
															<label class="label">Card radius (px)</label>
															<input id="cardRadius" type="range" min="0" max="40" value="10">
        </div>
															<div class="col">
																<label class="label">Glow size (px)</label>
																<input id="glowSize" type="range" min="4" max="60" value="15">
        </div>
																<div class="col">
																	<label class="label">Glow strength (0-1)</label>
																	<input id="glowStrength" type="range" min="0" max="1" step="0.01" value="0.25">
        </div>
																</div>
															</div>

															<div class="section">
																<h4>Snow & Particles</h4>
																<div class="row">
																	<div class="col">
																		<label class="label">Snow color</label>
																		<input id="snowColor" type="color" value="#ffffff">
        </div>
																		<div class="col">
																			<label class="label">Snow count: <span id="snowCountLabel">150</span></label>
																			<input id="snowCount" type="range" min="0" max="400" value="150">
        </div>
																			<div class="col">
																				<label class="label">Snow size: <span id="snowSizeLabel">3</span></label>
																				<input id="snowSize" type="range" min="1" max="10" value="3">
        </div>
																				<div class="col">
																					<label class="label">Snow speed: <span id="snowSpeedLabel">1.2</span></label>
																					<input id="snowSpeed" type="range" min="0.2" max="4" step="0.1" value="1.2">
        </div>
																				</div>
																			</div>
																		</div>

																		<div class="actions">
																			<button class="btn-ghost" id="applyBtn">Apply (autosaves)</button>
																			<button class="btn-primary" id="saveBtn">Save</button>
																		</div>
																	</div>

																	<script>
																		const DEFAULTS = {
  bg:'#0b0b0b',
  header:'#111111',
  text:'#ffffff',
  muted:'#cccccc',
  accent:'#ff6600',
  accentDark:'#ff3300',
  glowColor:'#ff6600',
  cardBg:'#000000',
  cardRadius:10,
  glowSize:15,
  glowStrength:0.25,
  fontFamily:'Arial, Helvetica, sans-serif',
  snowColor:'#ffffff',
  snowCount:150,
  snowSize:3,
  snowSpeed:1.2
};

const customizeBtn = document.getElementById('customizeBtn');
const settingsPanel = document.getElementById('settingsPanel');
const settingsDrag = document.getElementById('settingsDrag');

const els = {
  bgColor: document.getElementById('bgColor'),
  headerColor: document.getElementById('headerColor'),
  textColor: document.getElementById('textColor'),
  mutedColor: document.getElementById('mutedColor'),
  accentColor: document.getElementById('accentColor'),
  accentDark: document.getElementById('accentDark'),
  glowColor: document.getElementById('glowColor'),
  cardBg: document.getElementById('cardBg'),
  cardRadius: document.getElementById('cardRadius'),
  glowSize: document.getElementById('glowSize'),
  glowStrength: document.getElementById('glowStrength'),
  fontFamily: document.getElementById('fontFamily'),
  snowColor: document.getElementById('snowColor'),
  snowCount: document.getElementById('snowCount'),
  snowSize: document.getElementById('snowSize'),
  snowSpeed: document.getElementById('snowSpeed'),
  snowCountLabel: document.getElementById('snowCountLabel'),
  snowSizeLabel: document.getElementById('snowSizeLabel'),
  snowSpeedLabel: document.getElementById('snowSpeedLabel'),
};

const applyBtn = document.getElementById('applyBtn');
const saveBtn = document.getElementById('saveBtn');
const resetBtn = document.getElementById('resetBtn');
const exportBtn = document.getElementById('exportBtn');
const importBtn = document.getElementById('importBtn');
const importFile = document.getElementById('importFile');

function setVar(name,val){ document.documentElement.style.setProperty(name,val); }
function hexToRGBA(hex, alpha=1){
  if(!hex) return `rgba(255,255,255,${alpha})`;
  const h = hex.replace('#','');
  const n = parseInt(h,16);
  const r = (n >> 16) & 255;
  const g = (n >> 8) & 255;
  const b = n & 255;
  return `rgba(${r},${g},${b},${alpha})`;
}

function applySettings(s){
  const s2 = Object.assign({}, DEFAULTS, s || {});
  setVar('--bg', s2.bg);
  setVar('--header-bg', s2.header);
  setVar('--text', s2.text);
  setVar('--muted', s2.muted);
  setVar('--accent', s2.accent);
  setVar('--accent-dark', s2.accentDark);
  setVar('--accent-shadow', hexToRGBA(s2.glowColor,0.3));
  document.querySelectorAll('.game-card').forEach(card=>{
    card.style.boxShadow = `0 0 ${s2.glowSize}px ${hexToRGBA(s2.glowColor, s2.glowStrength)}`;
  });
  setVar('--card-bg', s2.cardBg);
  setVar('--card-radius', s2.cardRadius + 'px');
  setVar('--card-shadow', `0 0 ${Math.max(6,s2.glowSize/1.6)}px ${hexToRGBA(s2.glowColor,0.12)}`);
  setVar('--glow-size', s2.glowSize + 'px');
  setVar('--glow-strength', s2.glowStrength);
  setVar('--font-family', s2.fontFamily);
  setVar('--snow-color', hexToRGBA(s2.snowColor,1));
  setVar('--snow-count', s2.snowCount);
  setVar('--snow-size', s2.snowSize);
  setVar('--snow-speed', s2.snowSpeed);

  document.body.style.background = s2.bg;
  document.body.style.color = s2.text;
  const header = document.querySelector('header');
  if(header) header.style.background = s2.header;
  document.querySelectorAll('.game-card').forEach(c=> c.style.background = s2.cardBg);
  const gf = document.getElementById('gameFrame');
  if(gf) gf.style.borderColor = s2.accent;
}

const STORAGE_KEY = 'elite_gamez_theme_v1';
function saveSettings(obj){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
  saveBtn.textContent = 'Saved âœ“';
  setTimeout(()=> saveBtn.textContent = 'Save',900);
}
function loadSettings(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(!raw) return DEFAULTS;
  try { return Object.assign({}, DEFAULTS, JSON.parse(raw)); }
  catch(e){ console.error('bad settings json', e); return DEFAULTS; }
}
function resetToDefaults(){
  localStorage.removeItem(STORAGE_KEY);
  updateUIFromSettings(DEFAULTS);
  applySettings(DEFAULTS);
  updateSnow(DEFAULTS.snowCount, DEFAULTS.snowSize, DEFAULTS.snowSpeed, DEFAULTS.snowColor);
}

function updateUIFromSettings(s){
  els.bgColor.value = s.bg;
  els.headerColor.value = s.header;
  els.textColor.value = s.text;
  els.mutedColor.value = s.muted;
  els.accentColor.value = s.accent;
  els.accentDark.value = s.accentDark;
  els.glowColor.value = s.glowColor;
  els.cardBg.value = s.cardBg;
  els.cardRadius.value = s.cardRadius;
  els.glowSize.value = s.glowSize;
  els.glowStrength.value = s.glowStrength;
  els.fontFamily.value = s.fontFamily;
  els.snowColor.value = s.snowColor;
  els.snowCount.value = s.snowCount;
  els.snowSize.value = s.snowSize;
  els.snowSpeed.value = s.snowSpeed;
  els.snowCountLabel.textContent = s.snowCount;
  els.snowSizeLabel.textContent = s.snowSize;
  els.snowSpeedLabel.textContent = s.snowSpeed;
}

function readSettingsFromUI(){
  return {
    bg: els.bgColor.value,
    header: els.headerColor.value,
    text: els.textColor.value,
    muted: els.mutedColor.value,
    accent: els.accentColor.value,
    accentDark: els.accentDark.value,
    glowColor: els.glowColor.value,
    cardBg: els.cardBg.value,
    cardRadius: Number(els.cardRadius.value),
    glowSize: Number(els.glowSize.value),
    glowStrength: Number(els.glowStrength.value),
    fontFamily: els.fontFamily.value,
    snowColor: els.snowColor.value,
    snowCount: Number(els.snowCount.value),
    snowSize: Number(els.snowSize.value),
    snowSpeed: Number(els.snowSpeed.value)
  };
}

function wireControls(){
  Object.values(els).forEach(el=>{
    if(!el) return;
    el.addEventListener('input', () => {
      if(el === els.snowCount) els.snowCountLabel.textContent = el.value;
      if(el === els.snowSize) els.snowSizeLabel.textContent = el.value;
      if(el === els.snowSpeed) els.snowSpeedLabel.textContent = el.value;
      const s = readSettingsFromUI();
      applySettings(s);
      updateSnow(s.snowCount, s.snowSize, s.snowSpeed, s.snowColor);
      if(window._autosaveTimeout) clearTimeout(window._autosaveTimeout);
      window._autosaveTimeout = setTimeout(()=> saveSettings(s), 900);
    });
  });

  applyBtn.addEventListener('click', ()=>{
    const s = readSettingsFromUI();
    applySettings(s);
    updateSnow(s.snowCount, s.snowSize, s.snowSpeed, s.snowColor);
    saveSettings(s);
  });
  saveBtn.addEventListener('click', ()=> saveSettings(readSettingsFromUI()));
  resetBtn.addEventListener('click', ()=> {
    if(!confirm('like the orange color better? same')) return;
    resetToDefaults();
  });

  exportBtn.addEventListener('click', ()=>{
    const data = readSettingsFromUI();
    const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'theme.json';
    document.body.appendChild(a); a.click(); a.remove();
  });
  importBtn.addEventListener('click', ()=> importFile.click());
  importFile.addEventListener('change', (ev)=>{
    const f = ev.target.files && ev.target.files[0];
    if(!f) return;
    const reader = new FileReader();
    reader.onload = () => {
      try {
        const parsed = JSON.parse(reader.result);
        const merged = Object.assign({}, DEFAULTS, parsed);
        updateUIFromSettings(merged);
        applySettings(merged);
        saveSettings(merged);
        updateSnow(merged.snowCount, merged.snowSize, merged.snowSpeed, merged.snowColor);
        alert('Imported settings applied.');
      } catch(e) {
        alert('Failed to import: invalid JSON');
      }
    };
    reader.readAsText(f);
    importFile.value = '';
  });

  document.querySelectorAll('[data-preset]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const name = btn.getAttribute('data-preset');
      applyPreset(name);
    });
  });
}

const PRESETS = {
  Inferno: {
	bg:'#0a0a0a', header:'#1a1a1a', text:'#ffffff', muted:'#cccccc',
	accent:'#ff00aa', accentDark:'#ff00aa', glowColor:'#ff00ff', cardBg:'#000000',
	cardRadius:12, glowSize:25, glowStrength:0.5, fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
	snowColor:'#ffffff', snowCount:160, snowSize:3, snowSpeed:1.3
    
  },
kirby: { 
  bg:'#1A1A2E', header:'#1A1A2E', text:'#FFFFFF', muted:'#F8F1F1',
  accent:'#FF8EC6', accentDark:'#A50017', glowColor:'#FFC9D1', cardBg:'#2B2B45',
  cardRadius:10, glowSize:25, glowStrength:0.5, fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
  snowColor:'#e660ce', snowCount:160, snowSize:3, snowSpeed:1.4

},
mathias: { 
  bg:'#000000', header:'#000000', text:'#text: "#ffffff', muted:'#f8f1f1',
  accent:'#828282', accentDark:'#3d3d3d', glowColor:'#ffffff', cardBg:'#000000',
  cardRadius:10, glowSize:25, glowStrength:0.5, fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
  snowColor:'#ffffff', snowCount:160, snowSize:3, snowSpeed:1.4

},
  Ocean: {
    bg:'#021b2c', header:'#023047', text:'#e8f6ff', muted:'#a7d3f0',
    accent:'#00a3ff', accentDark:'#006bb3', glowColor:'#00baff', cardBg:'#00121a',
    cardRadius:12, glowSize:18, glowStrength:0.28, fontFamily:"'Roboto', Arial, sans-serif",
    snowColor:'#c8f0ff', snowCount:120, snowSize:3, snowSpeed:0.9
  },
  Neon: {
    bg:'#04040a', header:'#0b0b12', text:'#e7ffe7', muted:'#9ef3d1',
    accent:'#00ffb3', accentDark:'#00d18a', glowColor:'#00ffb3', cardBg:'#05050b',
    cardRadius:8, glowSize:30, glowStrength:0.5, fontFamily:"'VT323', monospace",
    snowColor:'#99ffdd', snowCount:200, snowSize:2, snowSpeed:1.6
  },
  Retro: {
    bg:'#0b0011', header:'#1a0337', text:'#ffe8d6', muted:'#ffd6a5',
    accent:'#ff66c4', accentDark:'#cc3aa0', glowColor:'#ff66c4', cardBg:'#140018',
    cardRadius:14, glowSize:12, glowStrength:0.2, fontFamily:"'Press Start 2P', cursive",
    snowColor:'#ffd6f0', snowCount:100, snowSize:4, snowSpeed:0.7
  },
  Dark: DEFAULTS,
  Light: {
    bg:'#f4f4f6', header:'#ffffff', text:'#111111', muted:'#666666',
    accent:'#0066ff', accentDark:'#0047b3', glowColor:'#66a3ff', cardBg:'#ffffff',
    cardRadius:8, glowSize:10, glowStrength:0.12, fontFamily:"Arial, Helvetica, sans-serif",
    snowColor:'#444444', snowCount:60, snowSize:2, snowSpeed:0.8
  }
};

function applyPreset(name){
  if(!PRESETS[name]) return;
  const p = PRESETS[name];
  updateUIFromSettings(p);
  applySettings(p);
  saveSettings(p);
  updateSnow(p.snowCount, p.snowSize, p.snowSpeed, p.snowColor);
}

customizeBtn.addEventListener('click', ()=>{
  settingsPanel.style.display = settingsPanel.style.display === 'block' ? 'none' : 'block';
});


(function makeDraggable(){
  let dragging = false, startX=0, startY=0, sx=0, sy=0;
  settingsDrag.addEventListener('pointerdown', (ev)=>{
    dragging = true;
    startX = ev.clientX; startY = ev.clientY;
    const rect = settingsPanel.getBoundingClientRect();
    sx = rect.left; sy = rect.top;
    settingsDrag.setPointerCapture(ev.pointerId);
  });
  window.addEventListener('pointermove', (ev)=>{
    if(!dragging) return;
    let dx = ev.clientX - startX;
    let dy = ev.clientY - startY;
    let nx = Math.max(8, Math.min(window.innerWidth - settingsPanel.offsetWidth - 8, sx + dx));
    let ny = Math.max(8, Math.min(window.innerHeight - 80, sy + dy));
    settingsPanel.style.left = nx + 'px';
    settingsPanel.style.top = ny + 'px';
    settingsPanel.style.right = 'auto';
    settingsPanel.style.position = 'fixed';
  });
  window.addEventListener('pointerup', ()=> { dragging = false; });
})();

const canvas = document.getElementById("snowCanvas");
const ctx = canvas.getContext("2d");
let snow = [];
let snowSettings = {count: DEFAULTS.snowCount, size: DEFAULTS.snowSize, speed: DEFAULTS.snowSpeed, color: DEFAULTS.snowColor};
function resizeCanvas(){ canvas.width = innerWidth; canvas.height = innerHeight; }
window.addEventListener('resize', resizeCanvas); resizeCanvas();

function createSnow(count, size){
  snow = [];
  for(let i=0;i<count;i++){
    snow.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      r: Math.random()*size + 0.5,
      d: Math.random()*1.5 + 0.2,
      sway: Math.random()*2*Math.PI,
      swayAmp: Math.random()*20
    });
  }
}
createSnow(snowSettings.count, snowSettings.size);

function updateSnow(count, size, speed, color){
  snowSettings.count = count;
  snowSettings.size = size;
  snowSettings.speed = speed;
  snowSettings.color = color;
  createSnow(count, size);
}

function drawSnow(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.beginPath();
  ctx.fillStyle = hexToRGBA(snowSettings.color || '#ffffff', 0.95);
  for(let f of snow){
    ctx.moveTo(f.x,f.y);
    ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
    f.y += f.d * snowSettings.speed;
    f.sway += 0.01 + Math.random()*0.02;
    f.x += Math.sin(f.sway) * 0.6;
    if(f.y > canvas.height + 20){ f.x = Math.random()*canvas.width; f.y = -10 - Math.random()*40; }
    if(f.x > canvas.width + 50) f.x = -20;
    if(f.x < -50) f.x = canvas.width + 20;
  }
  ctx.fill();
  requestAnimationFrame(drawSnow);
}
drawSnow();

const discordBtn = document.getElementById("discordBtn");
discordBtn.addEventListener('click', ()=> window.open("https://discord.gg/FGK4VBJTyd","_blank"));

const gameContainer = document.getElementById("gameContainer");
const searchInput = document.getElementById("searchInput");
const gameInfo = document.getElementById("gameInfo").querySelector("p");
const gameModal = document.getElementById("gameModal");
const gameFrame = document.getElementById("gameFrame");
const gameTitle = document.getElementById("gameTitle");
const closeModal = document.getElementById("closeModal");
const downloadBtn = document.getElementById("downloadBtn");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const aboutBlankBtn = document.getElementById("aboutBlankBtn");
const blobBtn = document.getElementById("blobBtn");

closeModal.onclick = () => {
gameModal.style.display = "none";
gameFrame.src = "about:blank";
};

async function loadGames() {
try {
const gamesURL = `https://cdn.jsdelivr.net/gh/elite-gamez/elite-gamez.github.io/games.json?cb=${Date.now()}`;
gamesData = await fetch(gamesURL).then(r => r.json());
renderGames();
} catch (e) {
console.error("Failed to load games:", e);
}
}

function renderGames() {
gameContainer.innerHTML = "";

gamesData.forEach(game => {
const imgURL = `https://rawcdn.githack.com/elite-gamez/elite-gamez.github.io/main/${game.image}`;
const card = document.createElement("div");
card.className = "game-card";
card.innerHTML = `
<img src="${imgURL}" alt="${game.title}">
<h2>${game.title}</h2>
<p>${game.description}</p>
`;
card.addEventListener("click", () => openGame(game));
gameContainer.appendChild(card);
});

gameInfo.textContent = `Games: ${gamesData.length}`;
}

async function openGame(game) {
const url = `https://rawcdn.githack.com/elite-gamez/elite-gamez.github.io/main/${game.url}`;
gameFrame.src = url;
gameTitle.textContent = game.title;
gameModal.style.display = "flex";

downloadBtn.onclick = async () => {
try {
const blob = await (await fetch(url)).blob();
const a = document.createElement("a");
a.href = URL.createObjectURL(blob);
a.download = game.title + ".html";
document.body.appendChild(a);
a.click();
a.remove();
} catch (e) {
alert("Download failed: " + e);
}
};

fullscreenBtn.onclick = () => {
if (gameFrame.requestFullscreen) gameFrame.requestFullscreen();
else alert("Fullscreen not supported");
};

aboutBlankBtn.onclick = () => {
const t = window.open("about:blank");
if (t) {
fetch(url)
.then(r => r.text())
.then(html => {
t.document.write(`<html>

<head>
	<title>${game.title}</title>
</head>

<body style="margin:0">${html}</body>

</html>`);
t.document.close();
})
.catch(err => alert("Failed to open in about:blank: " + err));
} else alert("Popup blocked!");
};

blobBtn.onclick = () => {
fetch(url)
.then(r => r.text())
.then(html => {
const blob = new Blob([html], { type: "text/html" });
window.open(URL.createObjectURL(blob), "_blank");
})
.catch(err => alert("Failed to open in Blob: " + err));
};
}

searchInput.addEventListener("input", () => {
const filter = searchInput.value.toLowerCase();
Array.from(gameContainer.children).forEach(card => {
card.style.display = card.querySelector("h2").textContent.toLowerCase().includes(filter) ? "flex" : "none";
});
});

const initial = loadSettings();
updateUIFromSettings(initial);
applySettings(initial);
updateSnow(initial.snowCount, initial.snowSize, initial.snowSpeed, initial.snowColor);
wireControls();
loadGames();
setInterval(loadGames, 30000);
																	</script>

	</body>

	</html>